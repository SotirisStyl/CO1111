<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Treasure Hunt Question</title>
</head>

<body>
<h1>Treasure Hunt Question</h1>
<div id="question"></div>
<form>
    <div id="answer-input"></div>
    <button type="submit">Submit Answer</button>
</form>

<script>
    // Get session ID from storage
    const session = sessionStorage.getItem('session');

    // Fetch question from API
    fetch(`https://codecyprus.org/th/api/question?session=` + session)
        .then(response => response.json())
        .then(jsonObject => {
            console.log(jsonObject);
            // Display question text
            const questionDiv = document.getElementById('question');
            questionDiv.innerHTML = `<p>${jsonObject.questionText}</p>`;

            // Create answer input based on question type
            const answerInputDiv = document.getElementById('answer-input');
            const inputType = getInputType(jsonObject.questionType);
            answerInputDiv.innerHTML = `<label for="answer">Answer:</label>
                <input type="${inputType}" id="answer" name="answer" required>` ;
        })
        .catch(error => console.error(error));

    // Handle form submission
    const form = document.querySelector('form');
    form.addEventListener('submit', (event) => {
        event.preventDefault();
        const answer = document.getElementById('answer').value;
        // Submit answer to API
        fetch(`https://codecyprus.org/th/api/answer?session=` + session + `&answer=` + answer)
            .then(response => response.json())
            .then(jsonObject => {
                console.log(jsonObject);
                // Display result message
                const resultDiv = document.getElementById('result');
                resultDiv.innerHTML = `<p>${jsonObject.message}</p>`;
            })
            .catch(error => console.error(error));
    });

    // Helper function to get input type based on question type
    function getInputType(questionType) {
        switch (questionType) {
            case 'BOOLEAN':
                return 'checkbox';
            case 'INTEGER':
                return 'number';
            case 'NUMERIC':
                return 'number';
            case 'MCQ':
                return 'radio';
            case 'TEXT':
                return 'text';
            default:
                return 'text';
        }
    }
</script>

<div id="result"></div>
</body>
</html>
